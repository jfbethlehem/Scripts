#!/bin/bash

RESDIR="Raw/Nikto"
mkdir -p $RESDIR

while [[ $# > 1 ]]
do
key="$1"

case $key in
    --client)
    OV_CLIENTNAME="$2"
    shift # past argument
    ;;
    --target)
    OV_SCANTARGET="$2"
    shift # past argument
    ;;
esac
shift # past argument or value
done

function usage
{
	echo "Usage: $0"
	echo "	--client	: Clientname"
	echo "	--target	: Target"
	echo ""
	echo "Example: $0 --client client --target localhost"
	exit 1
}

if [ -z "$OV_SCANTARGET" ]
	then
		echo "No base URL (-u) given."
		usage
		exit 1
fi
if [ -z "$OV_CLIENTNAME" ]
	then
		echo "No client name (-c)  given."
		usage
		exit 1
fi

nikto -update
nikto -host $OV_SCANTARGET -port 80 -output "$RESDIR/$OV_CLIENTNAME-$OV_SCANTARGET-nonssl.txt"
nikto -host $OV_SCANTARGET -ssl port 443 -output "$RESDIR/$OV_CLIENTNAME-$OV_SCANTARGET-ssl.txt"
