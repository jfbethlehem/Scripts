#!/usr/bin/env python

from __future__ import print_function
from nessrest import ness6rest, credentials
import os
import sys
import argparse

parser = argparse.ArgumentParser()

parser.add_argument("--username",  default='admin',
                    help="Nessus user name (admin)")
parser.add_argument("--password",  default='',
                    help="Nessus password", required=True)
parser.add_argument("--host",  default='localhost',
                    help="Nessus host (localhost)")
parser.add_argument("--client",  default='',
                    help="Client name", required=True)
parser.add_argument("--target",  default='',
                    help="Targets to scan", required=True)

args = parser.parse_args()

args.host = "https://%s:8834" % args.host

scan = ness6rest.Scanner(url=args.host, login=args.username, password=args.password, insecure="yes")

scanname = "%s-%s" % (args.client,args.target)

scan.policy_set("Northwave")

scan.scan_add(targets=args.target, name=scanname)
scan.scan_run()
scan.scan_results()
