#!/bin/bash

RESDIR="Raw/SSL"
mkdir -p $RESDIR

while [[ $# > 1 ]]
do
key="$1"

case $key in
    --client)
    OV_CLIENTNAME="$2"
    shift # past argument
    ;;
    --target)
    OV_SCANTARGET="$2"
    shift # past argument
    ;;
esac
shift # past argument or value
done

function usage
{
	echo "Usage: $0"
	echo "	--client	: Clientname"
	echo "	--target	: Target"
	echo ""
	echo "Example: $0 --client clientname --target localhost"
	exit 1
}

if [ -z "$OV_CLIENTNAME" ]
	then
		echo "No client name (-c) given."
		usage
		exit 1
fi
if [ -z "$OV_SCANTARGET" ]
	then
		echo "No scan target (-t) given."
		usage
		exit 1
fi

sslyze --http_get --hsts --chrome_sha1 --regular $OV_SCANTARGET 2>&1 > $RESDIR/$OV_CLIENTNAME-$OV_SCANTARGET.sslyze.txt
sslscan --show-certificate --ocsp --http --no-colour $OV_SCANTARGET 2>&1 > $RESDIR/$OV_CLIENTNAME-$OV_SCANTARGET.sslscan.txt
tlssled $OV_SCANTARGET 443 2>&1 > $RESDIR/$OV_CLIENTNAME-$OV_SCANTARGET.tlssled.txt && mv TLSSLed* $RESDIR

