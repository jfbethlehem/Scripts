#!/usr/bin/env bash

RESDIR="Raw/Whois"
mkdir -p $RESDIR

while [[ $# > 1 ]]
do
key="$1"

case $key in
    --client)
    OV_CLIENTNAME="$2"
    shift # past argument
    ;;
    --target)
    OV_SCANTARGET="$2"
    shift # past argument
    ;;
esac
shift # past argument or value
done

function usage
{
	echo "Usage: $0"
	echo "	--client	: Clientname"
	echo "	--target	: Target"
	echo ""
	echo "Example: $0 --client clientname -target localhost"
	exit 1
}

if [ -z "$OV_CLIENTNAME" ]
	then
		echo "No client name (-c) given."
		usage
		exit 1
fi
if [ -z "$OV_SCANTARGET" ]
	then
		echo "No scan target (-t) given."
		usage
		exit 1
fi

~/CMSMap/cmsmap.py -u A
~/CMSMap/cmsmap.py -t $OV_SCANTARGET -F >> $RESDIR/$OV_CLIENT-$OV_SCANTARGET.whois.txt
